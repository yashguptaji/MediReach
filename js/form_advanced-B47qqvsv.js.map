{"version":3,"file":"form_advanced-B47qqvsv.js","sources":["../../src/main-form-basic.js"],"sourcesContent":["// jQuery-free main.js for form_advanced.html - modern alternatives\n\n// Import security utilities\nimport { sanitizeHtml } from './utils/security.js';\n\n// Bootstrap 5 - No jQuery dependency needed\nimport * as bootstrap from 'bootstrap';\nwindow.bootstrap = bootstrap;\nglobalThis.bootstrap = bootstrap;\n\n// Global styles (Bootstrap 5 + custom) - most important for layout\nimport './main.scss';\n\n// Essential scripts for layout - modern versions\nimport './js/helpers/smartresize-modern.js';\nimport './js/sidebar-modern.js';\nimport './js/init-modern.js';\n\n// TempusDominus for date/time pickers\nimport { TempusDominus } from '@eonasdan/tempus-dominus';\nwindow.TempusDominus = TempusDominus;\n\n// TempusDominus CSS\nimport '@eonasdan/tempus-dominus/dist/css/tempus-dominus.min.css';\n\n// Switchery for iOS-style toggles\nimport Switchery from 'switchery';\nwindow.Switchery = Switchery;\n\n// Input Mask for input formatting\nimport Inputmask from 'inputmask';\nwindow.Inputmask = Inputmask;\n\n// NoUiSlider (Ion Range Slider replacement)\nimport noUiSlider from 'nouislider';\nwindow.noUiSlider = noUiSlider;\n\n// NoUiSlider CSS\nimport 'nouislider/dist/nouislider.css';\n\n// Choices.js (Select2 replacement)\nimport Choices from 'choices.js';\nwindow.Choices = Choices;\n\n// Choices.js CSS\nimport 'choices.js/public/assets/styles/choices.min.css';\n\n// Modern Color Picker (Pickr)\nimport * as PickrModule from '@simonwep/pickr';\nconst Pickr = PickrModule.default || PickrModule.Pickr || PickrModule;\nwindow.Pickr = Pickr;\n\n// Pickr CSS - Classic theme\nimport '@simonwep/pickr/dist/themes/classic.min.css';\n\n// Chart.js for circular progress (jQuery Knob replacement)\nimport { Chart, registerables } from 'chart.js';\nChart.register(...registerables);\nwindow.Chart = Chart;\n\n// Cropper.js 2.0 for image cropping (using cropperjs package)\nimport * as CropperModule from 'cropperjs';\n\n// Create a library availability checker for inline scripts\nwindow.waitForLibraries = function (libraries, callback, timeout = 5000) {\n  const startTime = Date.now();\n\n  function check() {\n    const allAvailable = libraries.every(lib => {\n      return typeof window[lib] !== 'undefined' || typeof globalThis[lib] !== 'undefined';\n    });\n\n    if (allAvailable) {\n      callback();\n    } else if (Date.now() - startTime < timeout) {\n      setTimeout(check, 50);\n    } else {\n      callback(); // Call anyway to prevent hanging\n    }\n  }\n\n  check();\n};\n\n// Dispatch a custom event when all modules are loaded\nwindow.dispatchEvent(\n  new CustomEvent('form-libraries-loaded', {\n    detail: {\n      timestamp: Date.now(),\n      libraries: {\n        jQuery: typeof window.$,\n        TempusDominus: typeof window.TempusDominus,\n        Cropper: typeof window.Cropper,\n        Pickr: typeof window.Pickr,\n        Inputmask: typeof window.Inputmask,\n        Switchery: typeof window.Switchery\n      }\n    }\n  })\n);\n\n// Also immediately trigger initialization when DOM is ready\ndocument.addEventListener('DOMContentLoaded', () => {\n  // Try to initialize directly\n  if (typeof window.initializeFormComponents === 'function') {\n    window.initializeFormComponents();\n  }\n\n  // -----------------------------\n  // Cropper.js v2 demo\n  // -----------------------------\n  const sourceImg = document.getElementById('cropper-source');\n  if (sourceImg && window.Cropper) {\n    const cropperInstance = new window.Cropper(sourceImg, {\n      container: sourceImg.parentElement\n    });\n    window.cropper = cropperInstance; // expose globally for debugging\n\n    // Helper to refresh preview canvas\n    const previewEl = document.getElementById('cropper-preview');\n    const refreshPreview = () => {\n      if (!previewEl) {\n        return;\n      }\n      const currentSel = cropperInstance.getCropperSelection();\n      if (!currentSel || currentSel.hidden) {\n        previewEl.innerHTML = sanitizeHtml('<span class=\"text-muted small\">No selection</span>');\n        return;\n      }\n      currentSel\n        .$toCanvas()\n        .then(canvas => {\n          previewEl.innerHTML = sanitizeHtml('');\n          canvas.style.width = '100%';\n          canvas.style.height = 'auto';\n          previewEl.appendChild(canvas);\n        });\n    };\n\n    // Rotate button\n    const rotateBtn = document.getElementById('cropper-rotate');\n    if (rotateBtn) {\n      rotateBtn.addEventListener('click', () => {\n        try {\n          const imgElement = cropperInstance.getCropperImage();\n          imgElement && imgElement.$rotate(90);\n          refreshPreview();\n        } catch (err) {\n        }\n      });\n    }\n\n    // Reset button\n    const resetBtn = document.getElementById('cropper-reset');\n    if (resetBtn) {\n      resetBtn.addEventListener('click', () => {\n        try {\n          cropperInstance.getCropperImage()?.$resetTransform();\n          cropperInstance.getCropperSelection()?.$reset();\n          refreshPreview();\n        } catch (err) {\n        }\n      });\n    }\n\n    // Download button\n    const downloadBtn = document.getElementById('cropper-download');\n    if (downloadBtn) {\n      downloadBtn.addEventListener('click', () => {\n        const selection = cropperInstance.getCropperSelection();\n        if (!selection) {\n          return;\n        }\n        selection\n          .$toCanvas()\n          .then(canvas => {\n            const link = document.createElement('a');\n            link.href = canvas.toDataURL('image/jpeg');\n            link.download = 'cropped-image.jpg';\n            link.click();\n          });\n      });\n    }\n\n    // Listen for any selection change events on the canvas\n    cropperInstance.getCropperCanvas()?.addEventListener('change', refreshPreview);\n\n    // Initial preview render after load\n    setTimeout(refreshPreview, 600);\n  }\n});\n"],"names":["window","bootstrap","globalThis","TempusDominus","Switchery","Inputmask","noUiSlider","Choices","Pickr","PickrModule.default","PickrModule.Pickr","PickrModule","Chart","register","registerables","waitForLibraries","libraries","callback","timeout","startTime","Date","now","check","every","lib","setTimeout","dispatchEvent","CustomEvent","detail","timestamp","jQuery","$","Cropper","document","addEventListener","initializeFormComponents","sourceImg","getElementById","cropperInstance","container","parentElement","cropper","previewEl","refreshPreview","currentSel","getCropperSelection","hidden","$toCanvas","then","canvas","innerHTML","sanitizeHtml","style","width","height","appendChild","rotateBtn","imgElement","getCropperImage","$rotate","err","resetBtn","$resetTransform","$reset","downloadBtn","selection","link","createElement","href","toDataURL","download","click","getCropperCanvas"],"mappings":"iaAOAA,OAAOC,UAAYA,EACnBC,WAAWD,UAAYA,EAYvBD,OAAOG,cAAgBA,EAOvBH,OAAOI,UAAYA,EAInBJ,OAAOK,UAAYA,EAInBL,OAAOM,WAAaA,EAOpBN,OAAOO,QAAUA,EAOjB,MAAMC,EAAQC,GAAuBC,EAAAA,OAAqBC,EAC1DX,OAAOQ,MAAQA,EAOfI,EAAMC,YAAYC,GAClBd,OAAOY,MAAQA,EAMfZ,OAAOe,iBAAmB,SAAUC,EAAWC,EAAUC,EAAU,KACjE,MAAMC,EAAYC,KAAKC,OAEvB,SAASC,IACcN,EAAUO,MAAMC,QACL,IAAhBxB,OAAOwB,SAAmD,IAApBtB,WAAWsB,IAI/DP,IACSG,KAAKC,MAAQF,EAAYD,EAClCO,WAAWH,EAAO,IAElBL,GAEJ,CAEAK,EACF,EAGAtB,OAAO0B,cACL,IAAIC,YAAY,wBAAyB,CACvCC,OAAQ,CACNC,UAAWT,KAAKC,MAChBL,UAAW,CACTc,cAAe9B,OAAO+B,EACtB5B,qBAAsBH,OAAOG,cAC7B6B,eAAgBhC,OAAOgC,QACvBxB,aAAcR,OAAOQ,MACrBH,iBAAkBL,OAAOK,UACzBD,iBAAkBJ,OAAOI,eAOjC6B,SAASC,iBAAiB,mBAAoB,KAEG,mBAApClC,OAAOmC,0BAChBnC,OAAOmC,2BAMT,MAAMC,EAAYH,SAASI,eAAe,kBAC1C,GAAID,GAAapC,OAAOgC,QAAS,CAC/B,MAAMM,EAAkB,IAAItC,OAAOgC,QAAQI,EAAW,CACpDG,UAAWH,EAAUI,gBAEvBxC,OAAOyC,QAAUH,EAGjB,MAAMI,EAAYT,SAASI,eAAe,mBACpCM,EAAiB,KACrB,IAAKD,EACH,OAEF,MAAME,EAAaN,EAAgBO,sBAC9BD,IAAcA,EAAWE,OAI9BF,EACGG,YACAC,KAAKC,IACJP,EAAUQ,UAAYC,EAAa,IACnCF,EAAOG,MAAMC,MAAQ,OACrBJ,EAAOG,MAAME,OAAS,OACtBZ,EAAUa,YAAYN,KATxBP,EAAUQ,UAAYC,EAAa,uDAcjCK,EAAYvB,SAASI,eAAe,kBACtCmB,GACFA,EAAUtB,iBAAiB,QAAS,KAClC,IACE,MAAMuB,EAAanB,EAAgBoB,kBACnCD,GAAcA,EAAWE,QAAQ,IACjChB,GACF,OAASiB,GACT,IAKJ,MAAMC,EAAW5B,SAASI,eAAe,iBACrCwB,GACFA,EAAS3B,iBAAiB,QAAS,KACjC,IACEI,EAAgBoB,mBAAmBI,kBACnCxB,EAAgBO,uBAAuBkB,SACvCpB,GACF,OAASiB,GACT,IAKJ,MAAMI,EAAc/B,SAASI,eAAe,oBACxC2B,GACFA,EAAY9B,iBAAiB,QAAS,KACpC,MAAM+B,EAAY3B,EAAgBO,sBAC7BoB,GAGLA,EACGlB,YACAC,KAAKC,IACJ,MAAMiB,EAAOjC,SAASkC,cAAc,KACpCD,EAAKE,KAAOnB,EAAOoB,UAAU,cAC7BH,EAAKI,SAAW,oBAChBJ,EAAKK,YAMbjC,EAAgBkC,oBAAoBtC,iBAAiB,SAAUS,GAG/DlB,WAAWkB,EAAgB,IAC7B"}